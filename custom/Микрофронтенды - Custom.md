# Микрофронтенды - Custom

Микрофронтенды - это относительно независимые веб-приложения, способные выполнятся в веб-контексте и взаимодействовать с сервером/другими веб-приложениями в том же контексте.

Микрофронтенды - вариант реализации сервис-ориентированной архитектуры на клиенте (в браузере).

Основные свойства микросервиса:
- Независимость развёртования и обновления. Возможность отключения микросервиса от системы без существенного ущерба.
- Выполняет только одну достаточно элементарную функцию.
- Зависимости с другими микросервисами одноранговые.
- Реализация сервиса с помощью различных фреймворков

![image](https://github.com/OboyaShka/frontendLectures/assets/66056854/f91bdcbb-ca29-437c-b207-cfd7a86e60f5)

Примеры:
- Виджет погоды
- Комментарии
- Корзина
- Аналитика
- Авторизация

Приемущества:
- Независимость разработки
- Компонентное тестирование
- Экспертиза привязана к компоненту
- Устройчивость системы (слабая связность)
- Автономность развёртования
- Короткий и независимы от других компанд релизный цикл

Недостатки:
- Повышенная сложность системы
- Проблемы со связью компонентов (нужна шина сообщений)

Требования к микрофронтенду:
- Дублирование кода (shared модули/компоненты)
- Инкапсуляция
- Эффективность взаимодействия
- Простота встраивания
- Использование разных фреймворков
- Приемущества развёртования/обновления

 Общие сущности | iframe | shadow dom | css modules | web worker
:------------ | :------------ | :-------------|  :-------------|  :-------------|
DOM | :white_check_mark: | :white_check_mark: | :white_large_square: | :white_large_square:
CSS | :white_large_square: | :white_check_mark: | :white_check_mark: | :white_large_square:
Globals | :white_check_mark: | :white_large_square: | :white_large_square: | :white_check_mark:
Memory | :white_check_mark: | :white_large_square: | :white_large_square: | :white_large_square:
Execution tread | :white_check_mark: | :white_large_square: | :white_large_square: | :white_check_mark:
User events | :white_large_square: | :white_large_square: | :white_large_square: | :white_large_square:
Network | :white_large_square: | :white_large_square: | :white_large_square: | :white_large_square:
Page adress | :white_large_square: | :white_large_square: | :white_large_square: | :white_large_square:
Cookies, cashe, db, local storage | :white_large_square: | :white_large_square: | :white_large_square: | :white_large_square:

Всё, что нельзя инкапсулировать, это веб-контекст, с которым взаимодействуют все микрофронтенды.

Технологии с помощью которых можно реализовать микрофронтенды
- iframe
- Module Federation
- web components (custom elements)

Критерий | + | -
:------------ | :------------ | :------------ |
Инкапсуляция | лучшие возможности, собственный window, контроль доступа через атрибуты allow/sandbox | 
Простота встраивания | легко добавляется | ограниченное пространство отрисовки (попапы), расходы по памяти, ограниченное пространство отрисовки
Возможность использования разных языков/фреймворков | Отсутствие ограничений | 
Отсутствие дублирования кода | Один кэш для http | Нет специальных средств
Взаимодействия |  | Нет простого способа взаимодействия с другими микрофронтендами. BroadcastChannel не работает в Safari. Обмен торлько через window.postMessage().
Развёртование | Независимое | 


